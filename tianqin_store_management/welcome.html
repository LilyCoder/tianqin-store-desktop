<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="./js/common/jquery-3.2.1.min.js"></script>
    <script src="./js/common/bootstrap.min.js"></script>
    <script src="./js/common/ajaxfileupload.js"></script>
    <script>
        $(function() {
            //头像预览
            $("#upload").click(function () {
//                $("#upload").click(); //隐藏了input:file样式后，点击头像就可以本地上传
                $("#upload").on("change",function(){
                    var objUrl = getObjectURL(this.files[0]) ; //获取图片的路径，该路径不是图片在本地的路径
                    if (objUrl) {
                        //$("#headPic").attr("src", objUrl) ; //将图片路径存入src中，显示出图片
                        alert(objUrl);
                    }
                });
            });

            //图片上传
            $("#submit_btn").click(function () {

                var imgurl = document.getElementById("upload").value;

                $.ajaxFileUpload({
                    url:"uploadHeadPic",
                    fileElementId: "upload", //文件上传域的ID，这里是input的ID，而不是img的
                    dataType: 'json', //返回值类型 一般设置为json
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    success: function (data) {
                        alert(data.code+" "+ data.msg);
                        if (data.code==200){

                            $("#headPic").attr("src","/market/images/image.png");
                            //将图片换成默认的+图片
                        }
                    }

                });


            });

        });

        //建立一個可存取到該file的url
        function getObjectURL(file) {
            var url = null ;
            if (window.createObjectURL!=undefined) { // basic
                url = window.createObjectURL(file) ;
            } else if (window.URL!=undefined) { // mozilla(firefox)
                url = window.URL.createObjectURL(file) ;
            } else if (window.webkitURL!=undefined) { // webkit or chrome
                url = window.webkitURL.createObjectURL(file) ;
            }
            return url ;
        }
    </script>
</head>
<body>
<!--<div class="container">-->
    <!--<div class="jumbotron">-->
        <!--<h1>欢迎登陆页面！</h1>-->
    <!--</div>-->
<!--</div>-->

<div >
    <!--<label >点击图片即可修改</label><br>-->
    <!--<img id="headPic" src="/market/images/image.png"  width="100px" height="100px" style="padding: 5px">-->
    <input id="upload" name="file" accept="image/*" type="file" style="display: block"/>
    <button id="submit_btn" type="submit">确定修改</button>
</div>


</body>
</html>